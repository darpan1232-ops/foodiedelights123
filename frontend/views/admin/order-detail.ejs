<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Details - Foodie Delights</title>
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="admin-header">
        <div class="admin-header-content">
            <h1>Order Details</h1>
            <div style="display: flex; align-items: center; gap: 2rem;">
                <ul class="admin-nav">
                    <li><a href="/admin/dashboard">Dashboard</a></li>
                    <li><a href="/admin/products">Products</a></li>
                    <li><a href="/admin/orders" class="active">Orders</a></li>
                </ul>
                <a href="/admin/logout" class="logout-btn">Logout</a>
            </div>
        </div>
    </div>

    <div class="admin-container">
        <a href="/admin/orders" style="color: var(--primary-color); margin-bottom: 1rem; display: inline-block;">‚Üê Back to Orders</a>

        <div class="order-detail-card">
            <h3>Customer Information</h3>
            <div class="order-info">
                <div class="info-item">
                    <label>Name</label>
                    <span><%= order.customerName %></span>
                </div>
                <div class="info-item">
                    <label>Email</label>
                    <span><%= order.customerEmail %></span>
                </div>
                <div class="info-item">
                    <label>Phone</label>
                    <span><%= order.customerPhone %></span>
                </div>
                <div class="info-item">
                    <label>Address</label>
                    <span><%= order.customerAddress %></span>
                </div>
            </div>
        </div>

        <div class="order-detail-card">
            <h3>Order Information</h3>
            <div class="order-info">
                <div class="info-item">
                    <label>Order ID</label>
                    <span><%= order._id %></span>
                </div>
                <div class="info-item">
                    <label>Order Date</label>
                    <span><%= new Date(order.orderDate).toLocaleString() %></span>
                </div>
                <div class="info-item">
                    <label>Status</label>
                    <span><span class="status-badge status-<%= order.status %>"><%= order.status %></span></span>
                </div>
                <div class="info-item">
                    <label>Total Amount</label>
                    <span style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">$<%= order.totalAmount.toFixed(2) %></span>
                </div>
            </div>

            <form method="POST" action="/admin/orders/update-status/<%= order._id %>" style="margin-top: 2rem;">
                <div class="form-group">
                    <label for="status">Update Status</label>
                    <select id="status" name="status" style="max-width: 300px;">
                        <option value="pending" <%= order.status === 'pending' ? 'selected' : '' %>>Pending</option>
                        <option value="confirmed" <%= order.status === 'confirmed' ? 'selected' : '' %>>Confirmed</option>
                        <option value="preparing" <%= order.status === 'preparing' ? 'selected' : '' %>>Preparing</option>
                        <option value="ready" <%= order.status === 'ready' ? 'selected' : '' %>>Ready</option>
                        <option value="delivered" <%= order.status === 'delivered' ? 'selected' : '' %>>Delivered</option>
                        <option value="cancelled" <%= order.status === 'cancelled' ? 'selected' : '' %>>Cancelled</option>
                    </select>
                </div>
                <button type="submit" class="btn">Update Status</button>
            </form>
        </div>

        <div class="order-detail-card">
            <h3>Order Items</h3>
            <div class="order-items">
                <table>
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% order.items.forEach(item => { %>
                            <tr>
                                <td>
                                    <% if (item.product) { %>
                                        <div style="display: flex; align-items: center; gap: 1rem;">
                                            <img src="<%= item.product.imageUrl %>" alt="<%= item.product.name %>" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;">
                                            <strong><%= item.product.name %></strong>
                                        </div>
                                    <% } else { %>
                                        <span>Product not found</span>
                                    <% } %>
                                </td>
                                <td><%= item.quantity %></td>
                                <td>$<%= item.price.toFixed(2) %></td>
                                <td>$<%= (item.price * item.quantity).toFixed(2) %></td>
                            </tr>
                        <% }); %>
                        <tr style="font-weight: 700; background-color: #f8f9fa;">
                            <td colspan="3" style="text-align: right;">Total:</td>
                            <td>$<%= order.totalAmount.toFixed(2) %></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>

